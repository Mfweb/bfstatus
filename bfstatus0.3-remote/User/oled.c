/**
  ******************************************************************************
  * @file    oled.c
  * @author  滨州学院智能车实验室 Mfweb(孙康)
  * @version V1.0
  * @date    2014年1月19日
  * @brief   使用模拟IIC  虽然标称最大400khz  实测几家厂商都可以到800khz
  ******************************************************************************
**/
#include "oled.h"
#include "stm32f10x_gpio.h"
#include "stm32f10x_i2c.h"
#include "stm32fx_delay.h"
#include <stdarg.h>
#include <stdio.h>
#include "key_led.h"

#define OLED_ADDRESS 0x78
const unsigned char font6x8[][6] =
 {
    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
    { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
    { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
    { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
    { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
    { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
    { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
    { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
    { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
    { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
    { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
    { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
    { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
    { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
    { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
    { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
    { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
    { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
    { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
    { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
    { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
    { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
    { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
    { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
    { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
    { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
    { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
    { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
    { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
    { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
    { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
    { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
    { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
    { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
    { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
    { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
    { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
    { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
    { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
    { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
    { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
    { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
    { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
    { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
    { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
    { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
    { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
    { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
    { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
    { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
    { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
    { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
    { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
    { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
    { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
    { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
    { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
    { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
    { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
    { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
    { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
    { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
    { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
    { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
    { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
    { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
    { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
    { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
    { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
    { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
    { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
    { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
    { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
    { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
    { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
    { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
    { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
    { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
    { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
    { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
    { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
    { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};
const unsigned char data_img_lock_[3][70]={
{12,140,140,12,12,12,12,12,12,12,12,12,12,12,12,12,252,252,0,0,0,0,0,192,240,124,63,51,48,48,48,12,152,176,144,128,128,254,254,128,128,176,152,140,0,0,0,0,120,120,24,24,24,24,24,24,24,26,31,30,28,24,24,24,24,24,24,120,120,0,},
{0,255,255,12,12,12,12,12,12,12,12,12,12,12,12,12,31,31,0,128,0,0,0,48,48,51,255,255,51,51,51,0,255,255,1,1,1,253,253,1,1,1,255,255,0,0,0,3,3,3,131,243,115,3,3,3,3,3,255,255,195,195,195,195,195,195,195,195,3,3,},
{0,31,63,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,60,31,7,0,0,0,0,16,63,31,8,12,38,96,115,51,24,28,14,3,6,12,12,24,51,115,32,0,0,32,112,60,15,3,7,12,24,24,48,48,63,63,48,48,48,48,48,48,48,48,48,16,}};
const unsigned char data_img_unlock_[3][70]={
{12,140,140,12,12,12,12,12,12,12,12,12,12,12,12,12,252,252,0,0,0,0,128,224,176,156,142,138,232,248,152,128,128,0,140,204,252,124,140,140,140,140,252,252,0,0,0,192,240,124,63,51,48,48,48,12,152,176,144,128,128,254,254,128,128,176,152,140,0,0,},
{0,255,255,12,12,12,12,12,12,12,12,12,12,12,12,12,31,31,0,128,0,0,0,0,255,255,136,255,255,136,136,255,255,65,243,125,60,48,49,253,253,49,49,48,0,0,0,48,48,51,255,255,51,51,51,0,255,255,1,1,1,253,253,1,1,1,255,255,0,0,},
{0,31,63,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,60,31,7,0,96,56,31,7,0,15,111,96,96,127,63,6,6,6,6,6,6,127,127,6,6,6,6,0,0,0,0,16,63,31,8,12,38,96,115,51,24,28,14,3,6,12,12,24,51,115,32,0,}};
const unsigned char singal_full_[1][8]={
{192,192,0,240,240,0,254,254}};
const unsigned char singal_null_[1][8]={
{192,192,0,66,36,24,36,66}};
const unsigned char bat_00_[1][5]={
{254,131,217,131,254}};
const unsigned char bat_01_[1][5]={
{254,195,193,195,254}};
const unsigned char bat_02_[1][5]={
{254,227,225,227,254}};
const unsigned char bat_03_[1][5]={
{254,243,241,243,254}};
const unsigned char bat_04_[1][5]={
{254,251,249,251,254}};
const unsigned char bat_05_[1][5]={
{254,255,255,255,254}};
const unsigned char hold_mode_data_[3][17]={
{192,48,8,4,2,2,241,1,1,1,241,2,2,4,8,48,192},
{7,24,32,64,128,128,31,1,1,1,31,128,128,64,32,24,7},
{0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0}};
const unsigned char hand_mode_data_[3][17]={
{192,48,8,4,2,242,225,1,1,129,97,242,2,4,8,48,192},
{7,24,32,64,128,159,0,7,24,7,0,159,128,64,32,24,7},
{0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0}};
const unsigned char uheard_mode_data_[3][17]={
{192,48,8,4,2,194,225,249,253,249,225,194,2,4,8,48,192},
{7,24,32,64,129,129,127,127,127,127,127,129,129,64,32,24,7},
{0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,}};
const unsigned char heard_mode_data_[3][17]={
{192,48,8,4,2,2,129,193,241,193,129,2,2,4,8,48,192},
{7,24,32,64,129,129,3,7,31,7,3,129,129,64,32,24,7},
{0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0}};
const unsigned char menu_fly_mode_[2][50]={
{8,8,8,8,8,8,248,64,160,16,0,0,0,32,144,200,36,64,72,72,72,200,72,64,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{0,0,0,0,0,0,1,6,8,17,60,0,0,1,0,63,0,0,0,32,32,63,0,0,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_ctrl_mode_[2][50]={
{32,252,32,0,48,144,84,24,80,144,48,0,0,96,88,80,252,80,80,64,240,0,0,252,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{34,63,1,0,33,34,34,62,34,34,33,0,0,0,31,1,63,17,31,0,7,32,32,63,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_ctrl_rate_[2][50]={
{32,252,32,0,48,144,84,24,80,144,48,0,0,96,88,80,252,80,80,64,240,0,0,252,0,0,68,200,0,232,40,40,252,40,40,232,8,0,0,8,40,72,104,88,204,72,40,72,40,8},
{34,63,1,0,33,34,34,62,34,34,33,0,0,0,31,1,63,17,31,0,7,32,32,63,0,0,32,31,32,41,37,35,63,35,37,41,32,0,0,8,10,9,10,11,62,11,10,9,10,8}};
const unsigned char menu_function_[2][50]={
{0,0,0,0,0,0,0,0,0,0,0,0,16,16,240,16,16,32,252,32,32,32,224,0,0,16,216,84,80,216,0,60,80,72,68,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,8,8,7,36,20,12,3,0,32,32,31,0,0,0,63,5,37,63,0,31,40,36,34,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
const unsigned char menu_calibration_[2][50]={
{0,0,0,0,0,0,0,0,0,0,0,0,32,160,252,160,16,144,84,24,80,144,16,0,0,16,32,128,64,240,156,144,244,152,144,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,2,1,63,0,33,32,23,8,23,32,33,0,0,16,8,4,0,63,36,36,63,36,36,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
const unsigned char menu_clear_line_[2][50]={0};
const unsigned char menu_pointer_[2][15]={
{240,240,240,240,240,240,240,252,248,248,240,224,192,192,128},
{7,7,7,7,7,7,7,31,15,15,7,3,1,1,0}};
const unsigned char menu_clear_pointer_[2][15]={0};
const unsigned char menu_fly_mode_hode_[2][50]={
{176,144,144,144,148,152,144,144,144,144,176,0,0,8,8,232,168,168,172,168,168,232,8,8,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{32,16,14,16,32,63,36,36,36,36,32,0,0,62,2,2,58,42,42,42,58,2,34,62,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_fly_mode_hand_[2][50]={
{0,72,72,72,72,248,68,68,68,68,0,0,0,64,72,200,72,64,0,32,252,32,32,224,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{2,2,2,34,34,63,2,2,2,2,2,0,0,12,11,8,10,12,32,24,7,32,32,31,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_ctrl_mode_uheard_[2][50]={
{128,136,136,136,136,248,136,136,136,136,128,0,0,0,32,64,8,16,0,252,0,0,0,0,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{32,16,8,4,3,0,31,32,32,32,56,0,0,33,33,17,17,9,7,1,5,9,17,33,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_ctrl_mode_heard_[2][50]={
{16,144,208,112,92,80,80,80,80,208,16,0,0,0,32,64,8,16,0,252,0,0,0,0,0,0,32,160,252,32,8,232,188,168,188,232,8,0,0,32,32,32,32,32,32,32,252,32,36,40},
{1,0,63,5,5,5,5,5,37,63,0,0,0,33,33,17,17,9,7,1,5,9,17,33,0,0,2,1,63,1,40,43,26,14,26,43,40,0,0,32,33,33,31,17,17,16,3,12,16,56}};
const unsigned char menu_ctrl_rate_slow_[2][50]={
{0,0,0,0,0,0,0,0,0,0,0,0,224,0,252,16,192,124,212,84,212,124,192,0,0,68,200,0,232,40,40,252,40,40,232,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,1,0,63,0,37,45,21,21,21,45,33,0,0,32,31,32,41,37,35,63,35,37,41,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
const unsigned char menu_ctrl_rate_medium_[2][50]={
{0,0,0,0,0,0,0,0,0,0,0,0,224,32,32,32,252,32,32,32,224,0,0,0,68,200,0,232,40,40,252,40,40,232,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,7,2,2,2,63,2,2,2,7,0,0,0,32,31,32,41,37,35,63,35,37,41,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
const unsigned char menu_ctrl_rate_fast_[2][50]={
{0,0,0,0,0,0,0,0,0,0,0,0,224,0,252,32,16,16,252,16,16,240,0,0,0,68,200,0,232,40,40,252,40,40,232,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,1,0,63,33,17,13,3,13,17,33,33,0,0,32,31,32,41,37,35,63,35,37,41,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
const unsigned char menu_function_collision_[2][50]={
{8,200,184,136,32,36,232,32,232,36,32,0,0,16,16,252,16,32,232,184,236,184,232,32,0,0,128,64,240,12,0,120,72,200,72,120,0,0,0,32,32,252,32,0,240,16,20,24,16,240},
{1,31,8,31,33,34,63,32,63,34,33,0,0,2,34,63,1,32,43,42,63,42,43,32,0,0,0,0,63,0,17,9,5,63,5,9,17,0,0,2,34,63,1,32,31,1,1,1,1,3}};
const unsigned char menu_function_throwing_[2][50]={
{0,240,84,88,80,240,80,88,84,240,0,0,0,8,16,0,128,96,28,208,16,16,80,48,0,0,0,72,72,72,72,248,68,68,68,68,0,0,0,32,252,32,64,252,64,192,16,252,16,240},
{4,5,5,5,5,63,5,5,5,5,4,0,0,8,4,34,16,8,6,1,6,8,16,32,0,0,2,2,2,34,34,63,2,2,2,2,2,0,0,34,63,1,32,31,0,31,36,35,36,55}};
const unsigned char menu_calibration_acc_[2][50]={
{0,32,32,224,0,252,96,128,64,32,16,0,0,0,40,200,8,8,248,8,8,136,104,0,0,0,32,160,252,160,16,144,84,24,80,144,16,0,0,16,32,128,64,240,156,144,244,152,144,16},
{16,8,6,33,32,63,0,1,6,8,16,0,0,2,2,2,2,2,63,2,2,2,2,2,0,0,2,1,63,0,33,32,23,8,23,32,33,0,0,16,8,4,0,63,36,36,63,36,36,32}};
const unsigned char menu_calibration_gyr_[2][50]={
{136,168,252,168,168,80,76,232,88,192,0,0,0,0,0,224,0,0,0,252,64,64,64,0,0,0,32,160,252,160,16,144,84,24,80,144,16,0,0,16,32,128,64,240,156,144,244,152,144,16},
{0,63,10,63,0,5,37,63,5,15,1,0,0,32,32,63,32,32,32,63,32,32,32,32,0,0,2,1,63,0,33,32,23,8,23,32,33,0,0,16,8,4,0,63,36,36,63,36,36,32}};
const unsigned char menu_calibration_joy_[2][50]={
{32,32,252,32,40,200,152,168,132,164,20,0,0,32,160,252,160,0,8,8,248,8,8,0,0,0,32,160,252,160,16,144,84,24,80,144,16,0,0,16,32,128,64,240,156,144,244,152,144,16},
{2,34,63,1,53,36,36,63,36,36,52,0,0,2,1,63,0,1,1,1,63,1,1,1,0,0,2,1,63,0,33,32,23,8,23,32,33,0,0,16,8,4,0,63,36,36,63,36,36,32}};
const unsigned char menu_select_[2][9]={
{0,0,0,0,0,192,112,56,8},
{6,14,28,28,7,1,0,0,0}};
const unsigned char menu_unselect_[2][9]={
{0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0}};

const unsigned char start_[8][128]={
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,248,224,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,63,63,60,184,32,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,96,192,128,0,0,224,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,224,64,0,0,7,31,31,31,31,31,63,62,248,224,227,254,252,248,248,240,244,252,252,192,224,0,1,1,1,1,1,1,1,96,128,0,151,248,248,224,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,0,128,0,248,160,0,0,0,0,64,0,130,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,249,240,224,244,246,242,240,252,251,254,255,255,15,3,129,192,224,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,194,134,206,143,191,254,255,254,254,254,254,255,255,255,255,255,255,255,255,255,255,247,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,14,15,15,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,7,15,31,31,15,31,127,255,255,255,255,255,255,255,255,255,255,199,147,59,57,253,253,252,252,252,248,225,241,255,255,255,255,255,127,63,15,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,7,15,15,31,31,31,63,63,63,127,127,127,127,127,63,31,159,143,199,99,49,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,},
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,224,248,120,112,97,97,67,67,71,70,14,14,14,6,3,3,1,1,0,8,14,15,15,15,126,248,0,0,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,}
};

//已锁定
const image_data data_img_lock={
	.width = 70,
	.height = 3,
	.data = (unsigned char **)data_img_lock_
};
//已解锁
const image_data data_img_unlock={
	.width = 70,
	.height = 3,
	.data = (unsigned char **)data_img_unlock_
};
//信号满
const image_data singal_full={
	.width = 8,
	.height = 1,
	.data = (unsigned char **)singal_full_
};
//信号空
const image_data singal_null={
	.width = 8,
	.height = 1,
	.data = (unsigned char **)singal_null_
};
//电池0-5
const image_data bat_00={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_00_
};
const image_data bat_01={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_01_
};
const image_data bat_02={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_02_
};
const image_data bat_03={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_03_
};
const image_data bat_04={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_04_
};
const image_data bat_05={
	.width = 5,
	.height = 1,
	.data = (unsigned char **)bat_05_
};
//图标-定高模式
const image_data hold_mode_data={
	.width = 17,
	.height = 3,
	.data = (unsigned char **)hold_mode_data_
};
//图标-手动模式
const image_data hand_mode_data={
	.width = 17,
	.height = 3,
	.data = (unsigned char **)hand_mode_data_
};
//图标-无头模式
const image_data uheard_mode_data={
	.width = 17,
	.height = 3,
	.data = (unsigned char **)uheard_mode_data_
};
//图标-有头模式
const image_data heard_mode_data={
	.width = 17,
	.height = 3,
	.data = (unsigned char **)heard_mode_data_
};
/*  一级菜单  */
//飞行模式
const image_data menu_fly_mode={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_fly_mode_
};
//控制模式
const image_data menu_ctrl_mode={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_mode_
};
//控制速率
const image_data menu_ctrl_rate={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_rate_
};
//功能
const image_data menu_function={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_function_
};
//校准
const image_data menu_calibration={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_calibration_
};
/*   二级菜单，选项   */
//定高模式
const image_data menu_fly_mode_hode={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_fly_mode_hode_
};
//手动模式
const image_data menu_fly_mode_hand={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_fly_mode_hand_
};
//无头模式
const image_data menu_ctrl_mode_uheard={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_mode_uheard_
};
//有头模式
const image_data menu_ctrl_mode_heard={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_mode_heard_
};
//慢速
const image_data menu_ctrl_rate_slow={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_rate_slow_
};
//中速
const image_data menu_ctrl_rate_medium={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_rate_medium_
};
//快速
const image_data menu_ctrl_rate_fast={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_ctrl_rate_fast_
};
//碰撞保护
const image_data menu_function_collision={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_function_collision_
};
//单次手抛起飞
const image_data menu_function_throwing={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_function_throwing_
};
//水平标定
const image_data menu_calibration_acc={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_calibration_acc_
};
//静止标定
const image_data menu_calibration_gyr={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_calibration_gyr_
};
//摇杆标定
const image_data menu_calibration_joy={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_calibration_joy_
};
//菜单选择及其他符号
const image_data menu_select={
	.width = 9,
	.height = 2,
	.data = (unsigned char **)menu_select_
};
const image_data menu_unselect={
	.width = 9,
	.height = 2,
	.data = (unsigned char **)menu_unselect_
};
const image_data menu_pointer={
	.width = 15,
	.height = 2,
	.data = (unsigned char **)menu_pointer_
};
const image_data menu_clear_pointer={
	.width = 15,
	.height = 2,
	.data = (unsigned char **)menu_clear_pointer_
};
const image_data menu_clear_line={
	.width = 50,
	.height = 2,
	.data = (unsigned char **)menu_clear_line_
};
const image_data start={
	.width = 128,
	.height = 8,
	.data = (unsigned char **)start_
};
void oled_init(void)
{
	uint8_t buf[21]={
	0xae,//0xae:关显示，0xaf:开显示
	0xd5,0x80,//显示时钟频率
	0xa8,0x3f,//复用率
	0xd3,0x00,//显示偏移
	0x40,//显示开始线
	0x8d,0x14,//VCC电源
	0xa1,//设置段重新映射
	0xc8,//COM输出方式
	0xda,0x12,//COM输出方式
	0x81,0xff,//对比度，指令：0x81，数据：0~255（255最高）
	//0xd9,0xf1,//充电周期
	//0xdb,0x30,//VCC电压输出
	0x20,0x00,//水平寻址设置
	0xa4,//0xa4:正常显示，0xa5:整体点亮
	0xa6,//0xa6:正常显示，0xa7:反色显示
	0xaf//0xae:关显示，0xaf:开显示
	};

	GPIO_QuickInit(GPIOB, GPIO_Pin_2, GPIO_Mode_Out_PP);//OLED RST
	GPIO_WriteBit(GPIOB, GPIO_Pin_2, Bit_RESET);
	DelayMs(50);
	GPIO_WriteBit(GPIOB, GPIO_Pin_2, Bit_SET);
	DelayMs(50);
	I2C_Write(OLED_ADDRESS,0x00,21,buf);
	oled_clear();
}

void oled_write_char(char *c)
{
	I2C_Write(OLED_ADDRESS,0x40,6,(unsigned char *)font6x8[(*c)-32]);
}

void oled_set_xy(uint8_t x,uint8_t y)
{
	Single_Write(OLED_ADDRESS,0x00,0xB0+y);
	Single_Write(OLED_ADDRESS,0x00,0x10+((x&0xF0)>>4));
	Single_Write(OLED_ADDRESS,0x00,0x00+(x&0x0f));
}
//写入英文字符串 （必须保证有英文字库）
void oled_write_english_string(uint8_t X,uint8_t Y,char *s)
{
 oled_set_xy(X,Y);
  while (*s) 
  {
		if(*s == '\n')
			oled_set_xy(X,++Y);
		else if(*s != '\r')
			oled_write_char(s);
		s++;
   }
}
void oled_printf(uint8_t x,uint8_t y,const char *fmt, ...)
{
	char outbuf[128/6];
	va_list ap;
	va_start(ap,fmt);
	vsprintf(outbuf,fmt,ap);
	oled_write_english_string(x,y,outbuf);
	va_end(ap);
}

void oled_clear(void)
{
	while(I2C_Start() == FALSE);
	I2C_SendByte(OLED_ADDRESS);
	I2C_WaitAck();
	I2C_SendByte(0x40);
	I2C_WaitAck();
	for (int16_t i=0; i<1024; i++)
	{
		I2C_SendByte(0x00);
		I2C_WaitAck();
	}
	I2C_Stop();
}

//显示图片  x:显示X起点   y:显示Y起点 
void oled_show_image(uint8_t x,uint8_t y,const image_data *buf)
{
	uint8_t i,j;
	for(i=0;i<buf->height;i++)
	{
		oled_set_xy(x,i+y);
		for(j=0;j<buf->width;j++)
		{
			//oled_show_bit();
			Single_Write(OLED_ADDRESS,0x40,*((unsigned char*)buf->data + buf->width*i + j));
		}
	}
}
